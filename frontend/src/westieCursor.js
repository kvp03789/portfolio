import Idle1 from './img/png/riley_animations/idle/riley_idle_sprite1.png'
import Idle2 from './img/png/riley_animations/idle/riley_idle_sprite2.png'
import Idle3 from './img/png/riley_animations/idle/riley_idle_sprite3.png'
import Idle4 from './img/png/riley_animations/idle/riley_idle_sprite4.png'
import Idle5 from './img/png/riley_animations/idle/riley_idle_sprite5.png'
import Idle6 from './img/png/riley_animations/idle/riley_idle_sprite6.png'
import Idle7 from './img/png/riley_animations/idle/riley_idle_sprite7.png'
import Idle8 from './img/png/riley_animations/idle/riley_idle_sprite8.png'
import Idle9 from './img/png/riley_animations/idle/riley_idle_sprite9.png'
import Idle10 from './img/png/riley_animations/idle/riley_idle_sprite10.png'
import Idle11 from './img/png/riley_animations/idle/riley_idle_sprite11.png'
import Idle12 from './img/png/riley_animations/idle/riley_idle_sprite12.png'
import Idle13 from './img/png/riley_animations/idle/riley_idle_sprite13.png'
import Idle14 from './img/png/riley_animations/idle/riley_idle_sprite14.png'
import Idle15 from './img/png/riley_animations/idle/riley_idle_sprite15.png'
import Idle16 from './img/png/riley_animations/idle/riley_idle_sprite16.png'
import Idle17 from './img/png/riley_animations/idle/riley_idle_sprite17.png'
import Up1 from './img/png/riley_animations/up/riley_up_sprite1.png'
import Up2 from './img/png/riley_animations/up/riley_up_sprite2.png'
import Up3 from './img/png/riley_animations/up/riley_up_sprite3.png'
import Up4 from './img/png/riley_animations/up/riley_up_sprite4.png'
import Up5 from './img/png/riley_animations/up/riley_up_sprite5.png'
import Up6 from './img/png/riley_animations/up/riley_up_sprite6.png'
import Up7 from './img/png/riley_animations/up/riley_up_sprite7.png'
import Down1 from './img/png/riley_animations/down/riley_down_sprite1.png'
import Down2 from './img/png/riley_animations/down/riley_down_sprite2.png'
import Down3 from './img/png/riley_animations/down/riley_down_sprite3.png'
import Down4 from './img/png/riley_animations/down/riley_down_sprite4.png'
import Down5 from './img/png/riley_animations/down/riley_down_sprite5.png'
import Down6 from './img/png/riley_animations/down/riley_down_sprite6.png'
import Down7 from './img/png/riley_animations/down/riley_down_sprite7.png'
import Left1 from './img/png/riley_animations/left/riley_left_sprite1.png'
import Left2 from './img/png/riley_animations/left/riley_left_sprite2.png'
import Left3 from './img/png/riley_animations/left/riley_left_sprite3.png'
import Left4 from './img/png/riley_animations/left/riley_left_sprite4.png'
import Left5 from './img/png/riley_animations/left/riley_left_sprite5.png'
import Left6 from './img/png/riley_animations/left/riley_left_sprite6.png'
import Right1 from './img/png/riley_animations/right/riley_right_sprite1.png'
import Right2 from './img/png/riley_animations/right/riley_right_sprite2.png'
import Right3 from './img/png/riley_animations/right/riley_right_sprite3.png'
import Right4 from './img/png/riley_animations/right/riley_right_sprite4.png'
import Right5 from './img/png/riley_animations/right/riley_right_sprite5.png'
import Right6 from './img/png/riley_animations/right/riley_right_sprite6.png'
import DownLeft1 from './img/png/riley_animations/down_left/riley_down_left_sprite1.png'
import DownLeft2 from './img/png/riley_animations/down_left/riley_down_left_sprite2.png'
import DownLeft3 from './img/png/riley_animations/down_left/riley_down_left_sprite3.png'
import DownLeft4 from './img/png/riley_animations/down_left/riley_down_left_sprite4.png'
import DownLeft5 from './img/png/riley_animations/down_left/riley_down_left_sprite5.png'
import DownLeft6 from './img/png/riley_animations/down_left/riley_down_left_sprite6.png'
import DownRight1 from './img/png/riley_animations/down_right/riley_down_right_sprite1.png'
import DownRight2 from './img/png/riley_animations/down_right/riley_down_right_sprite2.png'
import DownRight3 from './img/png/riley_animations/down_right/riley_down_right_sprite3.png'
import DownRight4 from './img/png/riley_animations/down_right/riley_down_right_sprite4.png'
import DownRight5 from './img/png/riley_animations/down_right/riley_down_right_sprite5.png'
import DownRight6 from './img/png/riley_animations/down_right/riley_down_right_sprite6.png'
import UpLeft1 from './img/png/riley_animations/up_left/riley_up_left_sprite1.png'
import UpLeft2 from './img/png/riley_animations/up_left/riley_up_left_sprite2.png'
import UpLeft3 from './img/png/riley_animations/up_left/riley_up_left_sprite3.png'
import UpLeft4 from './img/png/riley_animations/up_left/riley_up_left_sprite4.png'
import UpLeft5 from './img/png/riley_animations/up_left/riley_up_left_sprite5.png'
import UpLeft6 from './img/png/riley_animations/up_left/riley_up_left_sprite6.png'
import UpRight1 from './img/png/riley_animations/up_right/riley_up_right_sprite1.png'
import UpRight2 from './img/png/riley_animations/up_right/riley_up_right_sprite2.png'
import UpRight3 from './img/png/riley_animations/up_right/riley_up_right_sprite3.png'
import UpRight4 from './img/png/riley_animations/up_right/riley_up_right_sprite4.png'
import UpRight5 from './img/png/riley_animations/up_right/riley_up_right_sprite5.png'
import UpRight6 from './img/png/riley_animations/up_right/riley_up_right_sprite6.png'

const images = {
    'idle': [Idle1, Idle2, Idle3, Idle4, Idle5, Idle6, Idle7, Idle8, Idle9, Idle10, Idle11, Idle12, Idle13, Idle14, Idle15, Idle16, Idle17],
    'up': [Up1, Up2, Up3, Up4, Up5, Up6, Up7],
    'down': [Down1, Down2, Down3, Down4, Down5, Down6, Down7],
    'left': [Left1, Left2, Left3, Left4, Left5, Left6],
    'right': [Right1, Right2, Right3, Right4, Right5, Right6],
    'down_left': [DownLeft1, DownLeft2, DownLeft3, DownLeft4, DownLeft5, DownLeft6],
    'down_right': [DownRight1, DownRight2, DownRight3, DownRight4, DownRight5, DownRight6],
    'up_left': [UpLeft1, UpLeft2, UpLeft3, UpLeft4, UpLeft5, UpLeft6],
    'up_right': [UpRight1, UpRight2, UpRight3, UpRight4, UpRight5, UpRight6]
}


let mouseX = 0
let mouseY = 0
document.body.addEventListener('mousemove', (e) => {
    //mouse position
   mouseX = e.clientX;
   mouseY = e.clientY;
})


export class WestieCursor{
    constructor(posX, posY){
        this.posX = posX;
        this.posY = posY
        this.sprite = new Image
        this.speed = 1.5
        this.direction = 'idle'
        this.previousDirection = 'idle'

        this.currentFrame = 0
        this.lastFrameTime = 0;  // rrack time of last frame
        this.frameDuration = 55; // duration for each frame in ms (10 fps)

        this.canvas = document.createElement("canvas")
        this.ctx = this.canvas.getContext("2d")
    }

    init(){
        //canvas for dog cursor
        
        this.canvas.classList.add('cursor-canvas')
        document.body.append(this.canvas)
        this.sprite.src = images.idle[0]
    }

    getDirection(angle){
        if (angle >= -Math.PI / 8 && angle < Math.PI / 8) {
            return 'right';
        } else if (angle >= Math.PI / 8 && angle < 3 * Math.PI / 8) {
            return 'down_right';
        } else if (angle >= 3 * Math.PI / 8 && angle < 5 * Math.PI / 8) {
            return 'down';
        } else if (angle >= 5 * Math.PI / 8 && angle < 7 * Math.PI / 8) {
            return 'down_left';
        } else if (angle >= 7 * Math.PI / 8 || angle < -7 * Math.PI / 8) {
            return 'left';
        } else if (angle >= -7 * Math.PI / 8 && angle < -5 * Math.PI / 8) {
            return 'up_left';
        } else if (angle >= -5 * Math.PI / 8 && angle < -3 * Math.PI / 8) {
            return 'up';
        } else {
            return 'up_right';
        }
    
    }

    animate = (currentTime) => {
        const dx = mouseX - this.posX;
        const dy = mouseY - this.posY;
        const distance = Math.sqrt(dx * dx + dy * dy);
        //variable used to set idle as direction
        const isMoving = distance > this.speed

        //set the direction
        if(!isMoving){
            this.direction = 'idle'
        }
        else{
            //get angle from the coords
            const angle = Math.atan2(mouseY - this.posY, mouseX - this.posX);
            //get direction sprite should be facing using the angle
            
            this.direction = this.getDirection(angle)
        }

        this.previousDirection = this.direction
        const imageArray = images[this.direction]

        //increment currentFrame, set currentFrame = 0 if changing directions
        if(this.previousDirection != this.direction){
            this.currentFrame = 0
        }
        
        // check if enough time has passed to advance to the next frame
        if (currentTime - this.lastFrameTime > this.frameDuration) {
            this.currentFrame = (this.currentFrame + 1) % imageArray.length;
            this.lastFrameTime = currentTime; // update the last frame time
        }
   
       
        // move the sprite towards the cursor position
        if (isMoving) {
            // normalize the distance and apply speed
            this.posX += (dx / distance) * this.speed;
            this.posY += (dy / distance) * this.speed;
        }
        
        //set sprite.src to correct frame
        this.sprite.src = imageArray[this.currentFrame]

    }

    mainLoop = (currentTime) => {
        //maintain canvas fullscreen
        this.canvas.width = window.innerWidth
        this.canvas.height = window.innerHeight

        //clear previous draw
        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height)

        //animate method updates sprite image
        this.animate(currentTime)
  
        //draw sprite
        this.ctx.drawImage(this.sprite, this.posX, this.posY)

        requestAnimationFrame(this.mainLoop)
    }

}

const riley = new WestieCursor(50, 50)
riley.init()
riley.mainLoop()